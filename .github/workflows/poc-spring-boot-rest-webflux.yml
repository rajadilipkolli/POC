name: poc-spring-boot-webflux CI
on:
  push:
    paths:
      - "poc-spring-boot-rest/poc-spring-boot-rest-webflux/**"
    branches:
      - master
  pull_request:
    paths:
      - "poc-spring-boot-rest/poc-spring-boot-rest-webflux/**"
    types:
      - opened
      - synchronize
      - reopened


jobs:
  build:
    runs-on: ubuntu-latest
    name: Build on GraalVM
    steps:
      - uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - uses: ilammy/msvc-dev-cmd@v1.5.0
      - uses: microsoft/setup-msbuild@v1
      - uses: ayltai/setup-graalvm@v1
        with:
          java-version: 11
          graalvm-version: 20.3.0
          native-image: true
      - name: Build with Maven and analyze
        run: |
          cd poc-spring-boot-rest
          cd poc-spring-boot-rest-webflux
          mvn -B clean -Pnative package --file pom.xml 
      - name: Codecov
        uses: codecov/codecov-action@v2.1.0


